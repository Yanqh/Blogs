---
title: Java的类和对象
date: 2016-12-07 22:19:16
tags: 
- 类
- 对象
category: Java
keywords:
- Java
- 类
- 对象
---

Java的类和对象与Swift的类和对象有很多东西都是差不多的，但是也有不同的地方需要注意。写在这里以后查看。
<!-- more -->
<!-- toc -->

# 构造器

## 基本格式
需要注意的是构造器不需要返回值，在内部也不能出现return，因为编译器会隐式的返回类的实例。

{% tabbed_codeblock %}
<!-- tab Java -->
// 基本格式
public Type(param..) {
    code...
}
<!--endtab-->
{% endtabbed_codeblock %}

## 构造器的作用
构造器可以显式的初始化属性的值，每一个类都必须含有一个或一个以上的构造器。如果自定义了构造器，那么系统不会再默认生成构造器，一般情况下都再实现一次默认构造器。

## 构造器的重载
在构造器中可以调用其他构造器，使用`this`来调用，但必须为构造器的第一行代码。

# 静态与非静态
与Swift不同的是，静态的方法和属性可以由类或者对象来调用，而非静态的方法或实例只能由对象来调用。这和Swift中是完全不同的，在Swift中静态的只能类来调用，非静态的只能由对象来调用。

# this关键字的使用
this关键字的使用有两种情形：
- 在构造器中的引用表示正在初始化的对象。
- 在方法中的引用表示正在调用该方法的对象。

{% alert info no-icon %}
在静态方法中不能使用this这和Swift中类方法可以调用self是不同的。同样的是，this是可以省略的。
{% endalert %}

# 方法详解

## 方法的存在和调用
在Swift中方法可以脱离类独立存在，也可以独立调用，而Java的方法必须定义在类的内部，不能独立存在，也不能独立调用。

## 方法的传值方式
Java中的传值方式只有一种：值传递。也就是说，不论传入什么，都是实参的复制，形参的改变不会影响到实参的值。但是如果实参为应用变量，形参虽然是复制了实参，但是指向了同一块内存，所有，形参的变化也会影响到实参的变化，但还是值传递不是地址传递。

## 可变形参方法
可变形参其实是传入了一个数组，但这个数组只能放在最后，而且只能存在一个。
{% tabbed_codeblock %}
<!-- tab Java -->
void test(String...arr) {
}
<!--endtab-->
{% endtabbed_codeblock %}

## 方法的重载
方法名相同，但是参数不同就叫方法的重载。两同一不同：同一个类中，同一个方法名，不同的参数。注意，这里没有包括返回值的不同，也不要重载可变参数的方法，容易出现乱子。

## 局部变量和成员变量的选择
使用局部变量能够节省内存开销，而且在使用局部变量的时候也要注意尽量缩小局部变量的作用域。
如果数据对类或实例有依赖，或者在各个方法之间共享，那么应该使用成员变量。

# 关于包

## 建立包
在源文件中第一行非注释语句加入`package Yanqh`表示此文件中的所有类都将列入`Yanqh`这个包中，文件目录如下：`src/Yanqh/Demo.java`，相应的再编译后会生成相信的执行文件，目录如下：`out/Yanqh/Demo.class`。这样避免了类重名，也规范了文件存储的目录。

也可以在`Yanqh`中建立子包。在源文件中第一行非注释语句加入`package Yanqh.Diamond`。

## 引用包

### 普通引用
引用包需要在建立包之后，在类声明之前，引用如：`import Yanqh.Demo`，如果是引用包中的全部类，可以使用：`import YanQH.Demo.*`。

引用子包则需要在父包的名称带上，如：`import Yanqh.Diamond.*`。

### 静态引用
静态引用与普通引用最大的区别在于，静态引用可以直接应用属性和方法，不需要引用类。

{% alert info no-icon %}
注意子包和父包没有逻辑关系，只是文件的路径结构。
{% endalert %}

## 常用包

- java.lang：核心类，如String、Math、System、Thread等，默认导入。
- java.util：工具、集合类（接口），如Arrays、List、Set等。
- java.net：网络类（接口）。
- java.io：输入输出类（接口）。
- java.text：格式化类。
- java.sql：数据库相关类（接口）。
- java.awt：抽象窗口工具集的类（接口）。
- java.swing：图形界面类（接口）。

# 继承
Java中的继承是单继承，都有一个祖先类：Object。
## 继承的特点
Java的继承通过extend关键字来实现。虽然子类可以继承父类的所有属性和方法，但是不能继承父类的构造器。
## 方法的重写
重写方法要记住：两同两小一大，方法名和参数裂变相同；子类返回的值的类型小于等父类返回值的属性，子类抛出的异常类型小于等于父类抛出的异常类型；子类方法的访问权限大于等于父类方法的访问权限。
## super关键字
可以使用`super`来调用父类的实现。同样的是，不能再静态方法中调用`super`。如果在构造器中调用`super`来获取属性，那么获得的是父类定义的属性，而不是本类中的属性。

虽然子类不能继承父类的构造器，但是可以使用`super`来调用父类的构造器，不管子类是否显式的调用父类的构造器，系统都会逐级上调。

# 多态
## 概念
Java引用变量有两种类型：编译时类型和运行时类型。编译时类型由声明变量的类型决定的，运行时类型由赋值的对象决定的，如果编译时类型和运行时类型不一致就会形成多态。

{% alert info no-icon %}
注意引用变量在编译阶段只能滴啊用编译时类型的方法，不能调用运行时类型的方法。属性访问问编译时类型的属性。
{% endalert %}

## 强制类型转换
强制类型转换需要注意以下几点：
- 基本数据类型之间的转换只能在数值类型之间进行，数值类型不能和布尔类型之间转换。
- 引用类型的强制转换只能发生在有继承关系的类型上。

## instanceof运算符
instanceof运算符的前一个操作数一般是引用类型的变量，后一个一般为**有继承关系**的类，如果是返回true。

# 继承和组合
## 使用继承的注意点
- 尽量隐藏父类的属性，用private修饰。
- 不要让子类随意访问、修改父类的方法。使用private修饰辅助其他工具的方法，使用public修饰必须让外界调用的方法，使用final修饰不希望被重写的方法。
- 不要在父类构造器中调用可能被重写的方法。
- 用final修饰不想被继承的类。

## 使用组合
在两个类没有is-a关系的时候使用继承，但是如果两个类之间只是所属关系has-a，那么久使用组合。

# 初始块

初始化块是类的一部分，在构造器之前执行，分为静态和普通两种，不能加入参数，所以一般在一个类的一些属性固定时，可以使用初始化块，感觉用处不是很大。 


